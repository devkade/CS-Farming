---
up: 
related: 
tags: []
aliases: []
cssclasses:
  - dashboard
created: 2024-11-17T22:43
modified: 2024-11-17T23:06
---
# 3.11_Floating-Point_Code

- 부동 소수점 아키텍처는 부동 소수점 데이터에 대해 어떻게 프로그램이 동작하는지에 영향을 미친다. 다음과 같은 점들을 고려해야 한다.
	- 어떻게 부동 소수점 값이 저장되고 접근되는가. (일반적으로 일부 형태의 레지스터를 통해 이루어진다.)
	- 부동 소수점 데이터에 동작하는 명령어
	- 함수의 인자로 부동 소수점 값들을 전달하거나 함수의 결과로 반환 받을 때 사용되는 규약
	- 함수 호출 동안 레지스터들이 어떻게 유지되는지에 대한 규약

## x86-64 부동 소수점 아키텍처 이해를 위한 역사 공부

- 1997년 Pentium/MMX 도입 이후 Intel, AMD는 그래픽, 이미지 처리 지원을 위해 미디어 명령어를 통합해왔다.
- 미디어 명령어들은 SIMD(single instruction, multiple data / pronounced sim-dee) 로 알려진 병렬 처리를 허용하는 쪽에 중점을 두었다. 
	- 해당 모드에서는 여러 서로 다른 데이터 값에 대해 동일한 작업이 병렬로 수행된다.
- 세월이 흐르며 MMX → SSE(Streaming SIMD extensions) → AVX(Advanced vector extensions) 로 변경되었다.
- SSE 의 경우 XMM 이라 불리는 레지스터 집합에서 데이터를 관리한다. XMM은 128비트이다.
- AVX는 YMM이라 불리는 레지스터 집합에서 데이터를 관리하는데, YMM은 256 비트로, 각 YMM 레지스터는 8개의 32비트 값, 4개의 64비트 값을 저장할 수 있고, 정수 혹은 부동 소수점일 수 있다.

- 2000년 Pentium 4와 도입된 SSE2부터 미디어 명령어는 XMM 또는 YMM 레지스터의 최하위 32비트 또는 64비트에 단일 값을 사용하여 스칼라 부동 소수점 데이터를 처리한다.
- 모든 x86-64 코드를 실행할 수 있는 프로세서는 SSE2 또는 그 이상을 지원하며, 따라서 x86-64 부동 소수점은 SSE 또는 AVX에 기반한다.

- 해당 도서는 Core i7 Haswell 프로세서와 함께 2013년에 도입된 SIMD(단일 명령 다중 데이터) 확장인 AVX2를 기반으로 한다.

## Media Registers

![](https://i.imgur.com/2XU3dyP.png)

- 각 YMM 레지스터는 32 바이트를 보유한다. 
- Low-order 16바이트는 XMM 레지스터로 접근할 수 있다.
- 스칼라 데이터에 대해 작업할 때, YMM 레지스터들은 오직 부동 소수점 데이터만을 저장하고 32비트(float) 혹은 64비트(double)만 사용된다.
